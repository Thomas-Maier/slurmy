#!/usr/bin/env python3

import argparse
import os
import logging
from slurmy import JobHandler
from slurmy.tools.utils import _get_prompt, list_sessions, load, load_path

_log = logging.getLogger('slurmy')

## TODO: encapsulate utility in helper functions that just take jobhandler/job instances (instead of putting everything into the classes)
## TODO: allow for passing a config file, which holds the full jobs conifguration

if __name__ == '__main__':
  _parser = argparse.ArgumentParser(description = 'Slurmy interactive')
  _parser.add_argument('-p', '--path', metavar = 'PATH', dest = 'path', type = str, default = None, help = 'Path to existing session')
  _parser.add_argument('-c', '--config', metavar = 'CONFIG', dest = 'config', type = str, default = None, help = 'Job configuration file')
  _parser.add_argument('--debug', dest = 'debug', action = 'store_true', default = False, help = 'Debug mode')
  _args = _parser.parse_args()
  if _args.debug: _log.setLevel(level = logging.DEBUG)
  if _args.path: jh = load_path(_args.path)
  ## Load interactive session
  _get_prompt()()
